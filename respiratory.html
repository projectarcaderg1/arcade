<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- AFRAME -->
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

<!-- MINDAR -->
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<title>A.R.C.A.D.E</title>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#0b0f2a,#2a0b4f);
color:white;
text-align:center;
}

.ui{
position:fixed;
bottom:10px;
width:100%;
z-index:2;
}

button{
background:linear-gradient(45deg,#4cc9ff,#b517ff);
border:none;
color:white;
padding:12px;
margin:5px;
border-radius:10px;
font-size:16px;
box-shadow:0 0 15px #8a2be2;
}

textarea{
width:80%;
height:70px;
border-radius:10px;
padding:10px;
margin-top:5px;
}

#points{
font-size:18px;
margin-top:5px;
}
</style>
</head>

<body>

<div class="ui">
<h2>A.R.C.A.D.E</h2>

<button onclick="speakLesson()">üîä Listen</button>

<br>

<textarea id="reflection"
placeholder="What did you learn?"></textarea>

<br>

<button onclick="submitReflection()">Submit</button>

<div id="points">‚≠ê Points: 0</div>
</div>

<a-scene
mindar-image="imageTargetSrc: targets/respiratory.mind;"
color-space="sRGB"
embedded
vr-mode-ui="enabled:false"
device-orientation-permission-ui="enabled:false"
>

<!-- CAMERA -->
<a-camera position="0 0 0" look-controls="enabled:false"></a-camera>

<!-- STRONG LIGHTING (THIS FIXES INVISIBLE MODEL) -->
<a-light type="ambient" intensity="2"></a-light>
<a-light type="directional" position="0 2 1" intensity="3"></a-light>

<!-- PRELOAD MODEL -->
<a-assets>
<a-asset-item id="respModel" src="models/respiratory.glb"></a-asset-item>
</a-assets>

<!-- IMAGE TARGET -->
<a-entity mindar-image-target="targetIndex:0">

<a-gltf-model
src="#respModel"
position="0 0 0"
rotation="0 180 0"
scale="0.08 0.08 0.08"
visible="true">
</a-gltf-model>

</a-entity>

</a-scene>

<script>
let points=0;

function speakLesson(){
const text="The respiratory system allows humans to breathe. The lungs exchange oxygen and carbon dioxide to support life.";
speechSynthesis.cancel();
speechSynthesis.speak(new SpeechSynthesisUtterance(text));
}

function submitReflection(){
const value=document.getElementById("reflection").value;

if(value.trim()===""){
alert("Write your reflection first!");
return;
}

points+=10;
document.getElementById("points").innerText="‚≠ê Points: "+points;

celebrate();
}

function celebrate(){
for(let i=0;i<25;i++){
let e=document.createElement("div");
e.innerText=["üéâ","‚ú®","‚≠ê","üíú","üéä"][Math.floor(Math.random()*5)];
e.style.position="fixed";
e.style.left=Math.random()*100+"vw";
e.style.top="100vh";
e.style.fontSize="24px";
e.style.animation="fall 2s linear";
document.body.appendChild(e);
setTimeout(()=>e.remove(),2000);
}
}

const style=document.createElement("style");
style.innerHTML=`
@keyframes fall{
0%{transform:translateY(0);}
100%{transform:translateY(-100vh);}
}`;
document.head.appendChild(style);
</script>

</body>
</html>
